import { useEffect,useState } from 'react'; import { useNavigate } from 'react-router-dom'; import KawaiiCard from '../components/KawaiiCard.jsx'; import { getNotes,addNote,getPlans,addPlan,togglePlan } from '../api';
export default function Home(){ const nav=useNavigate(); const [user,setUser]=useState(''); const [notes,setNotes]=useState([]); const [plans,setPlans]=useState([]); const [newNote,setNewNote]=useState({title:'',content:''}); const [newPlan,setNewPlan]=useState(''); useEffect(()=>{ const u=localStorage.getItem('maye_user')||'Amor'; setUser(u); (async()=>{ setNotes(await getNotes(u)); setPlans(await getPlans(u)); })(); },[]); const logout=()=>{ localStorage.removeItem('maye_auth'); nav('/login',{replace:true}); };
return (<div className='min-h-screen p-6'><header className='max-w-5xl mx-auto flex items-center justify-between mb-6'><h2 className='font-display text-2xl text-ink'>Hola, {user} ♡</h2><div className='flex gap-3'><button onClick={logout} className='btn-kawaii bg-ink text-white'>Salir</button></div></header><section className='max-w-5xl mx-auto grid md:grid-cols-2 gap-5 mb-6'><div className='card-kawaii p-4'><h3 className='font-display text-xl mb-2'>Nueva notita</h3><input className='input-kawaii mb-2' placeholder='Título' value={newNote.title} onChange={e=>setNewNote(n=>({...n,title:e.target.value}))}/><textarea className='input-kawaii mb-2' rows='3' placeholder='Contenido' value={newNote.content} onChange={e=>setNewNote(n=>({...n,content:e.target.value}))}/><button className='btn-kawaii' onClick={async()=>{ const saved=await addNote({owner:user,...newNote}); setNotes([saved,...notes]); setNewNote({title:'',content:''}); }}>Guardar nota</button></div><div className='card-kawaii p-4'><h3 className='font-display text-xl mb-2'>Nuevo plan</h3><input className='input-kawaii mb-2' placeholder='Ir por helado rosa…' value={newPlan} onChange={e=>setNewPlan(e.target.value)}/><button className='btn-kawaii' onClick={async()=>{ const saved=await addPlan({owner:user,title:newPlan}); setPlans([saved,...plans]); setNewPlan(''); }}>Añadir plan</button></div></section><main className='max-w-5xl mx-auto grid md:grid-cols-2 gap-5'><KawaiiCard title='Tus notitas (BD)'><ul className='list-disc pl-5 space-y-1'>{notes.map(n=><li key={n.id}><b>{n.title}:</b> {n.content}</li>)}</ul></KawaiiCard><KawaiiCard title='Planes (BD)' footer='Click para marcar hecho'><ul className='list-disc pl-5 space-y-1'>{plans.map(p=>(<li key={p.id}><button onClick={async()=>{ const upd=await togglePlan(p.id); setPlans(plans.map(x=>x.id===upd.id?upd:x)); }} className='underline decoration-dotted'>{p.done?'✅':'⬜️'} {p.title}</button></li>))}</ul></KawaiiCard></main></div>); }
